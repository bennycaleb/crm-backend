{"ast":null,"code":"import React,{useEffect,useState}from'react';function AdminShopifyOrders(){const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[successMsg,setSuccessMsg]=useState('');const[sendingId,setSendingId]=useState(null);useEffect(()=>{fetch('/api/shopify/orders').then(res=>res.json()).then(data=>{setOrders(data);setLoading(false);}).catch(()=>{setError('Erreur lors du chargement des commandes');setLoading(false);});},[]);const handleSendToGlnet=async orderId=>{console.log('=== DÉBUT DE L\\'ENVOI À GLNET ===');console.log('Commande ID:',orderId);setSendingId(orderId);setSuccessMsg('');setError('');try{const url=\"http://localhost:5001/api/shopify/send-to-glnet/\".concat(orderId);console.log('URL de la requête:',url);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},mode:'cors',credentials:'include'});console.log('Status de la réponse:',response.status);console.log('Headers de la réponse:',Object.fromEntries(response.headers.entries()));const data=await response.json();console.log('Données reçues:',data);if(response.ok){setSuccessMsg(data.message);console.log('Succès:',data);}else{const errorMsg=data.error||'Erreur lors de l\\'envoi à gl-net';setError(errorMsg);console.error('Erreur:',errorMsg);}}catch(e){console.error('Exception lors de l\\'envoi:',e);setError('Erreur lors de l\\'envoi à gl-net: '+e.message);}finally{setSendingId(null);}};return/*#__PURE__*/React.createElement(\"div\",{style:{padding:24}},/*#__PURE__*/React.createElement(\"h2\",null,\"Commandes Shopify re\\xE7ues\"),loading&&/*#__PURE__*/React.createElement(\"p\",null,\"Chargement...\"),error&&/*#__PURE__*/React.createElement(\"p\",{style:{color:'red'}},error),successMsg&&/*#__PURE__*/React.createElement(\"p\",{style:{color:'green'}},successMsg),/*#__PURE__*/React.createElement(\"ul\",null,orders.map(order=>/*#__PURE__*/React.createElement(\"li\",{key:order.shopifyOrderId,style:{marginBottom:16,borderBottom:'1px solid #eee',paddingBottom:8}},/*#__PURE__*/React.createElement(\"strong\",null,\"ID Shopify:\"),\" \",order.shopifyOrderId,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"strong\",null,\"Date:\"),\" \",new Date(order.dateReception).toLocaleString(),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"details\",null,/*#__PURE__*/React.createElement(\"summary\",null,\"D\\xE9tails bruts\"),/*#__PURE__*/React.createElement(\"pre\",{style:{background:'#f8f8f8',padding:8}},JSON.stringify(order.data,null,2))),/*#__PURE__*/React.createElement(\"button\",{onClick:()=>handleSendToGlnet(order.shopifyOrderId),disabled:sendingId===order.shopifyOrderId,style:{marginTop:8,background:'#1976d2',color:'white',border:'none',borderRadius:4,padding:'8px 16px',cursor:'pointer'}},sendingId===order.shopifyOrderId?'Envoi en cours...':'Envoyer à gl-net')))));}export default AdminShopifyOrders;","map":{"version":3,"names":["React","useEffect","useState","AdminShopifyOrders","orders","setOrders","loading","setLoading","error","setError","successMsg","setSuccessMsg","sendingId","setSendingId","fetch","then","res","json","data","catch","handleSendToGlnet","orderId","console","log","url","concat","response","method","headers","mode","credentials","status","Object","fromEntries","entries","ok","message","errorMsg","e","createElement","style","padding","color","map","order","key","shopifyOrderId","marginBottom","borderBottom","paddingBottom","Date","dateReception","toLocaleString","background","JSON","stringify","onClick","disabled","marginTop","border","borderRadius","cursor"],"sources":["/Users/lbc/Desktop/CRM-J-main/src/AdminShopifyOrders.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nfunction AdminShopifyOrders() {\n  const [orders, setOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [successMsg, setSuccessMsg] = useState('');\n  const [sendingId, setSendingId] = useState(null);\n\n  useEffect(() => {\n    fetch('/api/shopify/orders')\n      .then(res => res.json())\n      .then(data => {\n        setOrders(data);\n        setLoading(false);\n      })\n      .catch(() => {\n        setError('Erreur lors du chargement des commandes');\n        setLoading(false);\n      });\n  }, []);\n\n  const handleSendToGlnet = async (orderId) => {\n    console.log('=== DÉBUT DE L\\'ENVOI À GLNET ===');\n    console.log('Commande ID:', orderId);\n    setSendingId(orderId);\n    setSuccessMsg('');\n    setError('');\n    \n    try {\n      const url = `http://localhost:5001/api/shopify/send-to-glnet/${orderId}`;\n      console.log('URL de la requête:', url);\n      \n      const response = await fetch(url, { \n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        mode: 'cors',\n        credentials: 'include'\n      });\n      \n      console.log('Status de la réponse:', response.status);\n      console.log('Headers de la réponse:', Object.fromEntries(response.headers.entries()));\n      \n      const data = await response.json();\n      console.log('Données reçues:', data);\n      \n      if (response.ok) {\n        setSuccessMsg(data.message);\n        console.log('Succès:', data);\n      } else {\n        const errorMsg = data.error || 'Erreur lors de l\\'envoi à gl-net';\n        setError(errorMsg);\n        console.error('Erreur:', errorMsg);\n      }\n    } catch (e) {\n      console.error('Exception lors de l\\'envoi:', e);\n      setError('Erreur lors de l\\'envoi à gl-net: ' + e.message);\n    } finally {\n      setSendingId(null);\n    }\n  };\n\n  return (\n    <div style={{ padding: 24 }}>\n      <h2>Commandes Shopify reçues</h2>\n      {loading && <p>Chargement...</p>}\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n      {successMsg && <p style={{ color: 'green' }}>{successMsg}</p>}\n      <ul>\n        {orders.map(order => (\n          <li key={order.shopifyOrderId} style={{ marginBottom: 16, borderBottom: '1px solid #eee', paddingBottom: 8 }}>\n            <strong>ID Shopify:</strong> {order.shopifyOrderId}<br />\n            <strong>Date:</strong> {new Date(order.dateReception).toLocaleString()}<br />\n            <details>\n              <summary>Détails bruts</summary>\n              <pre style={{ background: '#f8f8f8', padding: 8 }}>{JSON.stringify(order.data, null, 2)}</pre>\n            </details>\n            <button\n              onClick={() => handleSendToGlnet(order.shopifyOrderId)}\n              disabled={sendingId === order.shopifyOrderId}\n              style={{ marginTop: 8, background: '#1976d2', color: 'white', border: 'none', borderRadius: 4, padding: '8px 16px', cursor: 'pointer' }}\n            >\n              {sendingId === order.shopifyOrderId ? 'Envoi en cours...' : 'Envoyer à gl-net'}\n            </button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default AdminShopifyOrders; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAElD,QAAS,CAAAC,kBAAkBA,CAAA,CAAG,CAC5B,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGH,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACI,OAAO,CAAEC,UAAU,CAAC,CAAGL,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACM,KAAK,CAAEC,QAAQ,CAAC,CAAGP,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACQ,UAAU,CAAEC,aAAa,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACU,SAAS,CAAEC,YAAY,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CAEhDD,SAAS,CAAC,IAAM,CACda,KAAK,CAAC,qBAAqB,CAAC,CACzBC,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAACG,IAAI,EAAI,CACZb,SAAS,CAACa,IAAI,CAAC,CACfX,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACDY,KAAK,CAAC,IAAM,CACXV,QAAQ,CAAC,yCAAyC,CAAC,CACnDF,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAa,iBAAiB,CAAG,KAAO,CAAAC,OAAO,EAAK,CAC3CC,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC,CAChDD,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEF,OAAO,CAAC,CACpCR,YAAY,CAACQ,OAAO,CAAC,CACrBV,aAAa,CAAC,EAAE,CAAC,CACjBF,QAAQ,CAAC,EAAE,CAAC,CAEZ,GAAI,CACF,KAAM,CAAAe,GAAG,oDAAAC,MAAA,CAAsDJ,OAAO,CAAE,CACxEC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEC,GAAG,CAAC,CAEtC,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACU,GAAG,CAAE,CAChCG,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,QAAQ,CAAE,kBACZ,CAAC,CACDC,IAAI,CAAE,MAAM,CACZC,WAAW,CAAE,SACf,CAAC,CAAC,CAEFR,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEG,QAAQ,CAACK,MAAM,CAAC,CACrDT,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAES,MAAM,CAACC,WAAW,CAACP,QAAQ,CAACE,OAAO,CAACM,OAAO,CAAC,CAAC,CAAC,CAAC,CAErF,KAAM,CAAAhB,IAAI,CAAG,KAAM,CAAAQ,QAAQ,CAACT,IAAI,CAAC,CAAC,CAClCK,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEL,IAAI,CAAC,CAEpC,GAAIQ,QAAQ,CAACS,EAAE,CAAE,CACfxB,aAAa,CAACO,IAAI,CAACkB,OAAO,CAAC,CAC3Bd,OAAO,CAACC,GAAG,CAAC,SAAS,CAAEL,IAAI,CAAC,CAC9B,CAAC,IAAM,CACL,KAAM,CAAAmB,QAAQ,CAAGnB,IAAI,CAACV,KAAK,EAAI,kCAAkC,CACjEC,QAAQ,CAAC4B,QAAQ,CAAC,CAClBf,OAAO,CAACd,KAAK,CAAC,SAAS,CAAE6B,QAAQ,CAAC,CACpC,CACF,CAAE,MAAOC,CAAC,CAAE,CACVhB,OAAO,CAACd,KAAK,CAAC,6BAA6B,CAAE8B,CAAC,CAAC,CAC/C7B,QAAQ,CAAC,oCAAoC,CAAG6B,CAAC,CAACF,OAAO,CAAC,CAC5D,CAAC,OAAS,CACRvB,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,CAED,mBACEb,KAAA,CAAAuC,aAAA,QAAKC,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAG,CAAE,eAC1BzC,KAAA,CAAAuC,aAAA,WAAI,6BAA4B,CAAC,CAChCjC,OAAO,eAAIN,KAAA,CAAAuC,aAAA,UAAG,eAAgB,CAAC,CAC/B/B,KAAK,eAAIR,KAAA,CAAAuC,aAAA,MAAGC,KAAK,CAAE,CAAEE,KAAK,CAAE,KAAM,CAAE,EAAElC,KAAS,CAAC,CAChDE,UAAU,eAAIV,KAAA,CAAAuC,aAAA,MAAGC,KAAK,CAAE,CAAEE,KAAK,CAAE,OAAQ,CAAE,EAAEhC,UAAc,CAAC,cAC7DV,KAAA,CAAAuC,aAAA,WACGnC,MAAM,CAACuC,GAAG,CAACC,KAAK,eACf5C,KAAA,CAAAuC,aAAA,OAAIM,GAAG,CAAED,KAAK,CAACE,cAAe,CAACN,KAAK,CAAE,CAAEO,YAAY,CAAE,EAAE,CAAEC,YAAY,CAAE,gBAAgB,CAAEC,aAAa,CAAE,CAAE,CAAE,eAC3GjD,KAAA,CAAAuC,aAAA,eAAQ,aAAmB,CAAC,IAAC,CAACK,KAAK,CAACE,cAAc,cAAC9C,KAAA,CAAAuC,aAAA,UAAK,CAAC,cACzDvC,KAAA,CAAAuC,aAAA,eAAQ,OAAa,CAAC,IAAC,CAAC,GAAI,CAAAW,IAAI,CAACN,KAAK,CAACO,aAAa,CAAC,CAACC,cAAc,CAAC,CAAC,cAACpD,KAAA,CAAAuC,aAAA,UAAK,CAAC,cAC7EvC,KAAA,CAAAuC,aAAA,6BACEvC,KAAA,CAAAuC,aAAA,gBAAS,kBAAsB,CAAC,cAChCvC,KAAA,CAAAuC,aAAA,QAAKC,KAAK,CAAE,CAAEa,UAAU,CAAE,SAAS,CAAEZ,OAAO,CAAE,CAAE,CAAE,EAAEa,IAAI,CAACC,SAAS,CAACX,KAAK,CAAC1B,IAAI,CAAE,IAAI,CAAE,CAAC,CAAO,CACtF,CAAC,cACVlB,KAAA,CAAAuC,aAAA,WACEiB,OAAO,CAAEA,CAAA,GAAMpC,iBAAiB,CAACwB,KAAK,CAACE,cAAc,CAAE,CACvDW,QAAQ,CAAE7C,SAAS,GAAKgC,KAAK,CAACE,cAAe,CAC7CN,KAAK,CAAE,CAAEkB,SAAS,CAAE,CAAC,CAAEL,UAAU,CAAE,SAAS,CAAEX,KAAK,CAAE,OAAO,CAAEiB,MAAM,CAAE,MAAM,CAAEC,YAAY,CAAE,CAAC,CAAEnB,OAAO,CAAE,UAAU,CAAEoB,MAAM,CAAE,SAAU,CAAE,EAEvIjD,SAAS,GAAKgC,KAAK,CAACE,cAAc,CAAG,mBAAmB,CAAG,kBACtD,CACN,CACL,CACC,CACD,CAAC,CAEV,CAEA,cAAe,CAAA3C,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module"}